---
title: 机器学习算法：k-means
date: 2017-03-08 17:02:48
tags: [数据挖掘,机器学习]
categories: 机器学习
---
K-means算法学习
<!-- more -->
# 条件
待分类的特征矢量集为 $$x_1,x_2,x_3,……x_N$$
类别的数目已知：c

# 基本想法
取定 k 个类别，选取 k 个初始聚类中心，按最小距离原则将各模式分配到 k类 中的某一类，之后不断的计算类心和调整各模式的类别，最终使得各模式到其判属类别的距离平方之和最小。

# 算法步骤
1. 选择k个模式特征矢量作为初始聚类中心：{$ z{_1}{^{(0)}},z{_2}{^{(0)}}, z{_3}{^{(0)}} ,…… ,z{_k}{^{(0)}}$}。令 q = 0。

2. 将待分类的模式特征矢量集{$$ x_i $$}中的模式逐个按最小距离原则分划给 k类中的某一类，即：
如果
$$ d_{il}^{(q)} =  {\mathop{min}\limits_{ij}}[d_{ij}^{(q)}] $$
则判定
$$ x_i ∈ ω_l^{q+l} $$
式中，$$ d_{il}^{(q)} $$表示 $$ x_i $$ 和 $$ ω_j^{q} $$的中心 $$ z_j^{(j)} $$。上角标为迭代次数，于是产生了新的聚类 $$ ω_j^{(q+1)} $$ (j=1,2,3,……,k)

3. 计算重新分类后的各类心
$$ z_j^{q+1} =\frac{1}{n_j^{q+1}}\sum_{x_i ∈ \omega_j^{q+1}} x_i\tag{j = 1,2,3,……,k}$$ 式中：$n_j^{k+1}$ 为 $\omega_j^(k+1)$ 类中所含模式的个数

4. 如果 $ z_j^{q+1}=z_j^{q} $ ，则结束，否则返回（2）

# 算法实现
```python
import numpy as np
import pandas as pd
import copy as cp

def readData(filepath):
	file = pd.read_table(filepath,header=None,sep=' ')
	return file

def distance(vec1,vec2):
	return np.sqrt(sum(np.power((vec1-vec2).tolist(),2)))


def findClass(dataSetloc,centerSet):
	disitoZ = []
	for j in range(len(centerSet)):
		disitoZ.append(float(distance(dataSetloc,centerSet[j])))
	print(disitoZ)
	return(disitoZ.index(min(disitoZ)))


def adjustCenter(centerSet,classNumber):
	tempCenter=[]
	for i in range(classNumber):
		tempCenter.append([0,0,0])
	for i in range(classNumber):
		patternNum = len(centerSet[i])
		# 计算新的质心
		for nowX in centerSet[i]:
			tempCenter[i][0] += nowX[0]
			tempCenter[i][1] += nowX[1]
			tempCenter[i][2] += nowX[2]
		for j in range(3):
			tempCenter[i][j] = tempCenter[i][j] / patternNum
	return tempCenter

def isequal(class1,class2):
	return (class1[0]==class2[0] and class1[1]==class2[1])

pdDataSet = readData('dataset.txt')



k = int(input("输入类别数目:\n"))
center = []
classSet = []
classLabel = []
for i in range(k):
	print("请输入第",i+1,"个初始中心：")
	templist = list(input().split(','))
	templist = [float(num) for num in templist]
	center.append(templist)
	classSet.append([])
	classLabel.append([])
print('初始中心如下：')
print(center)


judgeValue = 1


global iterations
iterations = 0

```

dataset.txt内容：
```
-7.82 -4.58 -3.97
-6.68 3.16 2.71
4.36 -2.19 2.09
6.72 0.88 2.80
-8.64 3.06 3.50
-6.87 0.57 -5.45
4.47 -2.62 5.76
6.73 -2.01 4.18
-7.71 2.34 -6.33
-6.91 -0.49 -5.68
6.18 2.81 5.82
6.72 -0.93 -4.04
-6.25 -0.26 0.56
-6.94 -1.22 1.13
8.09 0.20 2.25
6.81 0.17 -4.15
-5.19 4.24 4.04
-6.38 -1.74 1.43
4.08 1.30 5.3
6.27 0.93 -2.78
```

# 运算结果
+ 题目一：$$ k = 2, m_{1}(0) = {(1,1,1)}^T,m_{2}(0)={(-1,1,-1)}^T $$
```
输入类别数目:
2
请输入第 1 个初始中心：
1,1,1
请输入第 2 个初始中心：
-1,1,-1
初始中心如下：
[[1.0, 1.0, 1.0], [-1.0, 1.0, -1.0]]
----------------------------------------
第 1 次循环
--------计算每个点到各类中心的距离--------
[11.559831313648138, 9.298908538102738]
[8.159172752185112, 7.119838481314025]
（此处省略）
----------当前各类中心位置----------
第 1 类中心位置为 [6.042999999999999, -0.14599999999999996, 1.7229999999999996]
第 2 类中心位置为 [-6.938999999999998, 0.508, -0.8060000000000003]
----------当前分类结果(数据)----------
[[[4.36, -2.19, 2.09], [6.72, 0.88, 2.8], [4.47, -2.62, 5.76], [6.73, -2.01, 4.18], [6.18, 2.81, 5.82], [6.72, -0.93, -4.04], [8.09, 0.2, 2.25], [6.81, 0.17, -4.15], [4.08, 1.3, 5.3], [6.27, 0.93, -2.78]], [[-7.82, -4.58, -3.97], [-6.68, 3.16, 2.71], [-8.64, 3.06, 3.5], [-6.87, 0.57, -5.45], [-7.71, 2.34, -6.33], [-6.91, -0.49, -5.68], [-6.25, -0.26, 0.56], [-6.94, -1.22, 1.13], [-5.19, 4.24, 4.04], [-6.38, -1.74, 1.43]]]
----------当前分类结果（对应索引）----------
[[2, 3, 6, 7, 10, 11, 14, 15, 18, 19], [0, 1, 4, 5, 8, 9, 12, 13, 16, 17]]
----------------------------------------
第 2 次循环
--------计算每个点到各类中心的距离--------
[15.6286075515383, 6.055972341416364]
[13.18250863834346, 4.411625664083479]
（此处省略）
----------当前各类中心位置----------
第 1 类中心位置为 [6.042999999999999, -0.14599999999999996, 1.7229999999999996]
第 2 类中心位置为 [-6.938999999999998, 0.508, -0.8060000000000003]
----------当前分类结果(数据)----------
[[[4.36, -2.19, 2.09], [6.72, 0.88, 2.8], [4.47, -2.62, 5.76], [6.73, -2.01, 4.18], [6.18, 2.81, 5.82], [6.72, -0.93, -4.04], [8.09, 0.2, 2.25], [6.81, 0.17, -4.15], [4.08, 1.3, 5.3], [6.27, 0.93, -2.78]], [[-7.82, -4.58, -3.97], [-6.68, 3.16, 2.71], [-8.64, 3.06, 3.5], [-6.87, 0.57, -5.45], [-7.71, 2.34, -6.33], [-6.91, -0.49, -5.68], [-6.25, -0.26, 0.56], [-6.94, -1.22, 1.13], [-5.19, 4.24, 4.04], [-6.38, -1.74, 1.43]]]
----------当前分类结果（对应索引）----------
[[2, 3, 6, 7, 10, 11, 14, 15, 18, 19], [0, 1, 4, 5, 8, 9, 12, 13, 16, 17]]
```

+ 题目二：$$ k = 2, m_{1}(0) = {(0,0,0)}^T,m_{2}(0)={(1,1,-1)}^T $$
```
输入类别数目:
2
请输入第 1 个初始中心：
0,0,0
请输入第 2 个初始中心：
1,1,-1
初始中心如下：
[[0.0, 0.0, 0.0], [1.0, 1.0, -1.0]]
----------------------------------------
第 1 次循环
--------计算每个点到各类中心的距离--------
[9.893922376893808, 10.85125338382622]
[7.870965633262542, 8.798414629920552]
(此处省略)
----------当前各类中心位置----------
第 1 类中心位置为 [-3.5535714285714293, -0.03142857142857136, 0.6621428571428571]
第 2 类中心位置为 [6.798333333333332, 0.6766666666666666, -0.016666666666666535]
----------当前分类结果(数据)----------
[[[-7.82, -4.58, -3.97], [-6.68, 3.16, 2.71], [4.36, -2.19, 2.09], [-8.64, 3.06, 3.5], [-6.87, 0.57, -5.45], [4.47, -2.62, 5.76], [6.73, -2.01, 4.18], [-7.71, 2.34, -6.33], [-6.91, -0.49, -5.68], [-6.25, -0.26, 0.56], [-6.94, -1.22, 1.13], [-5.19, 4.24, 4.04], [-6.38, -1.74, 1.43], [4.08, 1.3, 5.3]], [[6.72, 0.88, 2.8], [6.18, 2.81, 5.82], [6.72, -0.93, -4.04], [8.09, 0.2, 2.25], [6.81, 0.17, -4.15], [6.27, 0.93, -2.78]]]
----------当前分类结果（对应索引）----------
[[0, 1, 2, 4, 5, 6, 7, 8, 9, 12, 13, 16, 17, 18], [3, 10, 11, 14, 15, 19]]
----------------------------------------
第 2 次循环
--------计算每个点到各类中心的距离--------
[7.76844014232574, 16.029880172145184]
[4.914620109054872, 13.973801379724845]
(此处省略)
----------当前各类中心位置----------
第 1 类中心位置为 [-6.938999999999998, 0.508, -0.8060000000000003]
第 2 类中心位置为 [6.042999999999999, -0.14599999999999996, 1.7229999999999996]
----------当前分类结果(数据)----------
[[[-7.82, -4.58, -3.97], [-6.68, 3.16, 2.71], [-8.64, 3.06, 3.5], [-6.87, 0.57, -5.45], [-7.71, 2.34, -6.33], [-6.91, -0.49, -5.68], [-6.25, -0.26, 0.56], [-6.94, -1.22, 1.13], [-5.19, 4.24, 4.04], [-6.38, -1.74, 1.43]], [[4.36, -2.19, 2.09], [6.72, 0.88, 2.8], [4.47, -2.62, 5.76], [6.73, -2.01, 4.18], [6.18, 2.81, 5.82], [6.72, -0.93, -4.04], [8.09, 0.2, 2.25], [6.81, 0.17, -4.15], [4.08, 1.3, 5.3], [6.27, 0.93, -2.78]]]
----------当前分类结果（对应索引）----------
[[0, 1, 4, 5, 8, 9, 12, 13, 16, 17], [2, 3, 6, 7, 10, 11, 14, 15, 18, 19]]
----------------------------------------
第 3 次循环
--------计算每个点到各类中心的距离--------
[6.055972341416364, 15.6286075515383]
[4.411625664083479, 13.18250863834346]
(此处省略)
----------当前各类中心位置----------
第 1 类中心位置为 [-6.938999999999998, 0.508, -0.8060000000000003]
第 2 类中心位置为 [6.042999999999999, -0.14599999999999996, 1.7229999999999996]
----------当前分类结果(数据)----------
[[[-7.82, -4.58, -3.97], [-6.68, 3.16, 2.71], [-8.64, 3.06, 3.5], [-6.87, 0.57, -5.45], [-7.71, 2.34, -6.33], [-6.91, -0.49, -5.68], [-6.25, -0.26, 0.56], [-6.94, -1.22, 1.13], [-5.19, 4.24, 4.04], [-6.38, -1.74, 1.43]], [[4.36, -2.19, 2.09], [6.72, 0.88, 2.8], [4.47, -2.62, 5.76], [6.73, -2.01, 4.18], [6.18, 2.81, 5.82], [6.72, -0.93, -4.04], [8.09, 0.2, 2.25], [6.81, 0.17, -4.15], [4.08, 1.3, 5.3], [6.27, 0.93, -2.78]]]
----------当前分类结果（对应索引）----------
[[0, 1, 4, 5, 8, 9, 12, 13, 16, 17], [2, 3, 6, 7, 10, 11, 14, 15, 18, 19]]
```
+ 题目三：$$ k = 3, m_{1}(0) = {(0,0,0)}^T,m_{2}(0)={(1,1,1)}^T，m_{3}(0)={(-1,0,2)}^T $$
```
输入类别数目:
3
请输入第 1 个初始中心：
0,0,0
请输入第 2 个初始中心：
1,1,1
请输入第 3 个初始中心：
-1,0,2
初始中心如下：
[[0.0, 0.0, 0.0], [1.0, 1.0, 1.0], [-1.0, 0.0, 2.0]]
----------------------------------------
第 1 次循环
--------计算每个点到各类中心的距离--------
[9.893922376893808, 11.559831313648138, 10.155279415161358]
[7.870965633262542, 8.159172752185112, 6.538509004352599]
(此处省略)
----------当前各类中心位置----------
第 1 类中心位置为 [-7.327500000000001, -0.54, -5.3575]
第 2 类中心位置为 [6.042999999999999, -0.14599999999999996, 1.7229999999999996]
第 3 类中心位置为 [-6.680000000000001, 1.2066666666666668, 2.228333333333333]
----------当前分类结果(数据)----------
[[[-7.82, -4.58, -3.97], [-6.87, 0.57, -5.45], [-7.71, 2.34, -6.33], [-6.91, -0.49, -5.68]], [[4.36, -2.19, 2.09], [6.72, 0.88, 2.8], [4.47, -2.62, 5.76], [6.73, -2.01, 4.18], [6.18, 2.81, 5.82], [6.72, -0.93, -4.04], [8.09, 0.2, 2.25], [6.81, 0.17, -4.15], [4.08, 1.3, 5.3], [6.27, 0.93, -2.78]], [[-6.68, 3.16, 2.71], [-8.64, 3.06, 3.5], [-6.25, -0.26, 0.56], [-6.94, -1.22, 1.13], [-5.19, 4.24, 4.04], [-6.38, -1.74, 1.43]]]
----------当前分类结果（对应索引）----------
[[0, 5, 8, 9], [2, 3, 6, 7, 10, 11, 14, 15, 18, 19], [1, 4, 12, 13, 16, 17]]
----------------------------------------
第 2 次循环
--------计算每个点到各类中心的距离--------
[4.299920057396417, 15.6286075515383, 8.555959748749537]
[8.899090543420714, 13.18250863834346, 2.0118434056578285]
(此处省略)
----------当前各类中心位置----------
第 1 类中心位置为 [-7.327500000000001, -0.54, -5.3575]
第 2 类中心位置为 [6.042999999999999, -0.14599999999999996, 1.7229999999999996]
第 3 类中心位置为 [-6.680000000000001, 1.2066666666666668, 2.228333333333333]
----------当前分类结果(数据)----------
[[[-7.82, -4.58, -3.97], [-6.87, 0.57, -5.45], [-7.71, 2.34, -6.33], [-6.91, -0.49, -5.68]], [[4.36, -2.19, 2.09], [6.72, 0.88, 2.8], [4.47, -2.62, 5.76], [6.73, -2.01, 4.18], [6.18, 2.81, 5.82], [6.72, -0.93, -4.04], [8.09, 0.2, 2.25], [6.81, 0.17, -4.15], [4.08, 1.3, 5.3], [6.27, 0.93, -2.78]], [[-6.68, 3.16, 2.71], [-8.64, 3.06, 3.5], [-6.25, -0.26, 0.56], [-6.94, -1.22, 1.13], [-5.19, 4.24, 4.04], [-6.38, -1.74, 1.43]]]
----------当前分类结果（对应索引）----------
[[0, 5, 8, 9], [2, 3, 6, 7, 10, 11, 14, 15, 18, 19], [1, 4, 12, 13, 16, 17]]
```
+ 题目四：$$ k = 3, m_{1}(0) = {(-0.1,0,0.1)}^T,m_{2}(0)={(0,-0.1,0.1)}^T，m_{3}(0)={(-0.1,-0.1,0.1)}^T $$
```
输入类别数目:
3
请输入第 1 个初始中心：
-0.1,0,0.1
请输入第 2 个初始中心：
0,-0.1,0.1
请输入第 3 个初始中心：
-0.1,-0.1,0.1
初始中心如下：
[[-0.1, 0.0, 0.1], [0.0, -0.1, 0.1], [-0.1, -0.1, 0.1]]
----------------------------------------
第 1 次循环
--------计算每个点到各类中心的距离--------
[9.85594744304169, 9.888766353797626, 9.80987767507832]
[7.7520384415971515, 7.87795024102082, 7.79333689763249]
(此处省略)
----------当前各类中心位置----------
第 1 类中心位置为 [-7.018000000000001, 2.6740000000000004, -0.30600000000000005]
第 2 类中心位置为 [6.042999999999999, -0.14599999999999996, 1.7229999999999996]
第 3 类中心位置为 [-6.860000000000001, -1.658, -1.306]
----------当前分类结果(数据)----------
[[[-6.68, 3.16, 2.71], [-8.64, 3.06, 3.5], [-6.87, 0.57, -5.45], [-7.71, 2.34, -6.33], [-5.19, 4.24, 4.04]], [[4.36, -2.19, 2.09], [6.72, 0.88, 2.8], [4.47, -2.62, 5.76], [6.73, -2.01, 4.18], [6.18, 2.81, 5.82], [6.72, -0.93, -4.04], [8.09, 0.2, 2.25], [6.81, 0.17, -4.15], [4.08, 1.3, 5.3], [6.27, 0.93, -2.78]], [[-7.82, -4.58, -3.97], [-6.91, -0.49, -5.68], [-6.25, -0.26, 0.56], [-6.94, -1.22, 1.13], [-6.38, -1.74, 1.43]]]
----------当前分类结果（对应索引）----------
[[1, 4, 5, 8, 16], [2, 3, 6, 7, 10, 11, 14, 15, 18, 19], [0, 9, 12, 13, 17]]
----------------------------------------
第 2 次循环
--------计算每个点到各类中心的距离--------
[8.16630981533275, 15.6286075515383, 4.0689777586022755]
[3.0735477871671364, 13.18250863834346, 6.274852986325655]
(此处省略)
----------当前各类中心位置----------
第 1 类中心位置为 [-7.055000000000001, 3.2, 0.98]
第 2 类中心位置为 [6.042999999999999, -0.14599999999999996, 1.7229999999999996]
第 3 类中心位置为 [-6.861666666666667, -1.2866666666666666, -1.9966666666666668]
----------当前分类结果(数据)----------
[[[-6.68, 3.16, 2.71], [-8.64, 3.06, 3.5], [-7.71, 2.34, -6.33], [-5.19, 4.24, 4.04]], [[4.36, -2.19, 2.09], [6.72, 0.88, 2.8], [4.47, -2.62, 5.76], [6.73, -2.01, 4.18], [6.18, 2.81, 5.82], [6.72, -0.93, -4.04], [8.09, 0.2, 2.25], [6.81, 0.17, -4.15], [4.08, 1.3, 5.3], [6.27, 0.93, -2.78]], [[-7.82, -4.58, -3.97], [-6.87, 0.57, -5.45], [-6.91, -0.49, -5.68], [-6.25, -0.26, 0.56], [-6.94, -1.22, 1.13], [-6.38, -1.74, 1.43]]]
----------当前分类结果（对应索引）----------
[[1, 4, 8, 16], [2, 3, 6, 7, 10, 11, 14, 15, 18, 19], [0, 5, 9, 12, 13, 17]]
----------------------------------------
第 3 次循环
--------计算每个点到各类中心的距离--------
[9.25289819461989, 15.6286075515383, 3.9570812054678215]
[1.7706284195166417, 13.18250863834346, 6.477542615323603]
(此处省略)
----------当前各类中心位置----------
第 1 类中心位置为 [-6.836666666666667, 3.486666666666667, 3.4166666666666665]
第 2 类中心位置为 [6.042999999999999, -0.14599999999999996, 1.7229999999999996]
第 3 类中心位置为 [-6.982857142857143, -0.7685714285714286, -2.615714285714286]
----------当前分类结果(数据)----------
[[[-6.68, 3.16, 2.71], [-8.64, 3.06, 3.5], [-5.19, 4.24, 4.04]], [[4.36, -2.19, 2.09], [6.72, 0.88, 2.8], [4.47, -2.62, 5.76], [6.73, -2.01, 4.18], [6.18, 2.81, 5.82], [6.72, -0.93, -4.04], [8.09, 0.2, 2.25], [6.81, 0.17, -4.15], [4.08, 1.3, 5.3], [6.27, 0.93, -2.78]], [[-7.82, -4.58, -3.97], [-6.87, 0.57, -5.45], [-7.71, 2.34, -6.33], [-6.91, -0.49, -5.68], [-6.25, -0.26, 0.56], [-6.94, -1.22, 1.13], [-6.38, -1.74, 1.43]]]
----------当前分类结果（对应索引）----------
[[1, 4, 16], [2, 3, 6, 7, 10, 11, 14, 15, 18, 19], [0, 5, 8, 9, 12, 13, 17]]
----------------------------------------
第 4 次循环
--------计算每个点到各类中心的距离--------
[10.98184410743478, 15.6286075515383, 4.130603553269874]
[0.7941242556006796, 13.18250863834346, 6.62484932443211]
(此处省略)
----------当前各类中心位置----------
第 1 类中心位置为 [-6.836666666666667, 3.486666666666667, 3.4166666666666665]
第 2 类中心位置为 [6.042999999999999, -0.14599999999999996, 1.7229999999999996]
第 3 类中心位置为 [-6.982857142857143, -0.7685714285714286, -2.615714285714286]
----------当前分类结果(数据)----------
[[[-6.68, 3.16, 2.71], [-8.64, 3.06, 3.5], [-5.19, 4.24, 4.04]], [[4.36, -2.19, 2.09], [6.72, 0.88, 2.8], [4.47, -2.62, 5.76], [6.73, -2.01, 4.18], [6.18, 2.81, 5.82], [6.72, -0.93, -4.04], [8.09, 0.2, 2.25], [6.81, 0.17, -4.15], [4.08, 1.3, 5.3], [6.27, 0.93, -2.78]], [[-7.82, -4.58, -3.97], [-6.87, 0.57, -5.45], [-7.71, 2.34, -6.33], [-6.91, -0.49, -5.68], [-6.25, -0.26, 0.56], [-6.94, -1.22, 1.13], [-6.38, -1.74, 1.43]]]
----------当前分类结果（对应索引）----------
[[1, 4, 16], [2, 3, 6, 7, 10, 11, 14, 15, 18, 19], [0, 5, 8, 9, 12, 13, 17]]
```
（话说：latax写公式的感觉好爽啊……）
